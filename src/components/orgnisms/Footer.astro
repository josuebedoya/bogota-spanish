---
import SuscribeOurNewsLetter from "../orgnisms/SuscribeOurNewsLetter.astro";
import Menu from "@/components/species/Menu.astro";
import Copyright from "../species/Copyright.astro";
import directus from "@/server/directus";
import { readItems } from "@directus/sdk";
import { staticData } from "@/server/static-data";

const dataMenu = await directus?.request(
  readItems("Menu", {
    status: { _eq: "published" },
  }),
);

// Data formatting function
const formattedData = (data: any[]) => {
  return data?.map((item, i) => ({
    id: item.id || i + 1,
    label: item.Title_Item,
    slug: item.Link_Item,
    subItems: [],
  }));
};

// Formatted menus data
const menuImportantLinks = formattedData(
  dataMenu?.filter((item) => item?.Position?.[0] === "1"),
);

const menuHelpCenter = formattedData(
  dataMenu?.filter((item) => item?.Position?.[0] === "2"),
);

const menuHeader = formattedData(
  dataMenu?.filter((item) => item?.Position?.[0] === "0"),
);
---

<footer class="footer-area style-01">
  <div class="footer-top">
    <div class="container custom-container-01">
      <SuscribeOurNewsLetter />
      <div class="footer-middle">
        <div class="row">
          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="footer-widget widget widget_nav_menu">
              <h4 class="widget-headline">
                {staticData.footer.titles.menu1}
              </h4>
              <Menu menuItems={menuImportantLinks} />
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="footer-widget widget widget_nav_menu">
              <h4 class="widget-headline">
                {staticData.footer.titles.menu2}
              </h4>
              <Menu menuItems={menuHelpCenter} />
            </div>
          </div>
          <div class="col-lg-2 col-md-6 col-sm-6">
            <div class="footer-widget widget widget_nav_menu">
              <h4 class="widget-headline">
                {staticData.footer.titles.menu3}
              </h4>
              <Menu menuItems={menuHeader} />
            </div>
          </div>
          <div class="col-lg-2 col-md-6 col-sm-6">
            <div class="footer-widget widget widget_nav_menu">
              <h4 class="widget-headline">
                {staticData.footer.titles.contact}
              </h4>
              <ul class="contact_info_list">
                <li class="single-info-item">
                  <a href="tel:+573158044370">
                    <div class="icon">
                      <i class="fa fa-phone"></i>
                    </div>
                    <div class="details">
                      8502 Preston Rd. Inglewood, Maine Bangladesh
                    </div>
                  </a>
                </li>
                <li class="single-info-item">
                  <a href="mailto:administrativo@thebogotaspanish.com">
                    <div class="icon">
                      <i class="fa fa-envelope"></i>
                    </div>
                    <div class="details">
                      administrativo@thebogotaspanish.com
                    </div>
                  </a>
                </li>
                <li class="single-info-item">
                  <a
                    href="https://maps.app.goo.gl/2nnFTpCDuHAUuyD8A"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <div class="icon">
                      <i class="fa fa-map-marker-alt"></i>
                    </div>
                    <div class="details">Calle 131 a #53-31 Ap. 1005</div>
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <Copyright />
  </div>
</footer>
